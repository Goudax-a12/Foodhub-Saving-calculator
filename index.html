<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Foodhub Savings Calculator</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root {
  --foodhub-red:#E4002B;
  --foodhub-green:#1FA971;
  --bg:#F5F6F8;
}
body {
  font-family: Arial, sans-serif;
  background: var(--bg);
  margin: 0;
  padding: 15px;
}
.container {
  max-width: 900px;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 6px 16px rgba(0,0,0,.12);
  margin: auto;
}
.header {
  background: var(--foodhub-red);
  color: white;
  padding: 16px;
}
.content { padding: 16px; }
h3 {
  margin-top: 25px;
  border-bottom: 2px solid #eee;
  padding-bottom: 6px;
}
.row {
  display: flex;
  flex-direction: column;
  margin-bottom: 12px;
}
label { font-size: 14px; margin-bottom: 4px; }
input {
  padding: 8px;
  border-radius: 6px;
  border: 1px solid #ccc;
}
button {
  background: var(--foodhub-red);
  color: white;
  border: none;
  padding: 12px;
  border-radius: 6px;
  cursor: pointer;
  width: 100%;
  margin-top: 15px;
}
.result { font-weight: bold; font-size: 16px; }
.badge {
  background: var(--foodhub-green);
  color: white;
  padding: 10px;
  border-radius: 8px;
  margin-top: 10px;
  text-align: center;
}
.notice {
  background: #fff3cd;
  color: #856404;
  padding: 10px;
  border-radius: 8px;
  margin-top: 10px;
}
canvas { margin-top: 20px; }
</style>
</head>

<body>

<div class="container">
  <div class="header">
    <h2>Foodhub vs Flipdish Savings Calculator</h2>
  </div>

  <div class="content">

    <h3>Agent & Store</h3>
    <div class="row"><label>Agent Name</label><input id="agent"></div>
    <div class="row"><label>Store Name</label><input id="store"></div>

    <h3>Business</h3>
    <div class="row"><label>Monthly Orders</label><input id="orders" type="number" value="1000"></div>
    <div class="row"><label>Average Order Value (£)</label><input id="aov" type="number" value="20"></div>
    <div class="row"><label>% Card Orders</label><input id="cardRate" type="number" value="70"></div>

    <h3>Flipdish</h3>
    <div class="row"><label>Commission (%)</label><input id="fdComm" value="2"></div>
    <div class="row"><label>Monthly Fee (£)</label><input id="fdFee" value="99"></div>
    <div class="row"><label>Service Charge (£ / order – customer pays)</label><input id="fdService" value="0.5"></div>

    <h3>Foodhub</h3>
    <div class="row"><label>Commission (%)</label><input id="fhComm" value="0"></div>
    <div class="row"><label>Monthly Fee (£)</label><input id="fhFee" value="0"></div>
    <div class="row"><label>Service Charge (£ / order to shop)</label><input id="fhService" value="0.5"></div>
    <div class="row"><label>Card Fee (£ / card order)</label><input id="fhCardFee" value="0.2"></div>

    <button id="calcBtn">Calculate</button>

    <h3>Results</h3>
    <div class="row"><label>Flipdish Monthly Cost (£)</label><div id="fdCost" class="result">–</div></div>
    <div class="row"><label>Foodhub Monthly Cost (£)</label><div id="fhCost" class="result">–</div></div>
    <div class="row"><label>Monthly Savings (£)</label><div id="monthly" class="result">–</div></div>
    <div class="row"><label>Annual Savings (£)</label><div id="annual" class="result">–</div></div>

    <div id="confidence" class="badge"></div>
    <div id="customerNotice" class="notice"></div>

    <canvas id="monthlyChart"></canvas>
    <canvas id="annualChart"></canvas>

  </div>
</div>

<script>
const GOOGLE_SHEET_WEBHOOK = "https://script.google.com/macros/s/AKfycbxS7hvWEbB0Ki1q0FEoGwWPKRFa06oJFTwlrySCzcpbIUhUdy1KWSe7pEiz2lcu-_w_/exec";

// INPUTS
const agent = document.getElementById("agent");
const store = document.getElementById("store");
const orders = document.getElementById("orders");
const aov = document.getElementById("aov");
const cardRate = document.getElementById("cardRate");
const fdComm = document.getElementById("fdComm");
const fdFee = document.getElementById("fdFee");
const fdService = document.getElementById("fdService");
const fhComm = document.getElementById("fhComm");
const fhFee = document.getElementById("fhFee");
const fhService = document.getElementById("fhService");
const fhCardFee = document.getElementById("fhCardFee");

// OUTPUTS
const fdCostEl = document.getElementById("fdCost");
const fhCostEl = document.getElementById("fhCost");
const monthlyEl = document.getElementById("monthly");
const annualEl = document.getElementById("annual");
const confidenceEl = document.getElementById("confidence");
const customerNoticeEl = document.getElementById("customerNotice");

let monthlyChart, annualChart;

document.getElementById("calcBtn").addEventListener("click", calculate);

function calculate() {
  const o = Number(orders.value);
  const a = Number(aov.value);
  const cardPct = Number(cardRate.value) / 100;

  const fdPct = Number(fdComm.value) / 100;
  const fhPct = Number(fhComm.value) / 100;

  const turnover = o * a;
  const cardOrders = o * cardPct;

  const fdCost = (turnover * fdPct) + Number(fdFee.value);
  const fhCost = (turnover * fhPct)
    + Number(fhFee.value)
    + (cardOrders * Number(fhCardFee.value))
    - (o * Number(fhService.value));

  const savings = fdCost - fhCost;
  const annualSavings = savings * 12;
  const customerExtra = o * Number(fdService.value);

  fdCostEl.textContent = fdCost.toFixed(2);
  fhCostEl.textContent = fhCost.toFixed(2);
  monthlyEl.textContent = savings.toFixed(2);
  annualEl.textContent = annualSavings.toFixed(2);

  confidenceEl.textContent = `High confidence savings: £${annualSavings.toFixed(0)} per year`;
  customerNoticeEl.textContent =
    `Your customers pay £${customerExtra.toFixed(0)} more per month on Flipdish, and the restaurant does not receive this.`;

  drawCharts(fdCost, fhCost, annualSavings);
}

function drawCharts(fd, fh, annual) {
  if (monthlyChart) monthlyChart.destroy();
  if (annualChart) annualChart.destroy();

  monthlyChart = new Chart(document.getElementById("monthlyChart"), {
    type: "bar",
    data: {
      labels: ["Flipdish", "Foodhub"],
      datasets: [{
        label: "Monthly Cost (£)",
        data: [fd, fh],
        backgroundColor: ["#E4002B", "#1FA971"]
      }]
    }
  });

  annualChart = new Chart(document.getElementById("annualChart"), {
    type: "bar",
    data: {
      labels: ["Annual Savings"],
      datasets: [{
        label: "£",
        data: [annual],
        backgroundColor: ["#1FA971"]
      }]
    }
  });
}
</script>

</body>
</html>
